FROM python:3.7.6

ENV MLFLOW_VERSION 1.6.0
ENV MLFLOW_S3_BUCKET_NAME mlflow-utils
ENV MLFLOW_BACKEND_STORE_URI /opt/mlflow

RUN pip install boto3 mlflow==${MLFLOW_VERSION}
RUN mkdir -p ${MLFLOW_BACKEND_STORE_URI}

EXPOSE 5000
CMD mlflow server \
    --backend-store-uri file://${MLFLOW_BACKEND_STORE_URI} \
    --default-artifact-root s3://${MLFLOW_S3_BUCKET_NAME}/ \
    --host 0.0.0.0
